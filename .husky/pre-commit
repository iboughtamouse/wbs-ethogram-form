echo "ğŸ” Running tests on changed files..."
npm test -- --onlyChanged --passWithNoTests --silent || { 
  echo "âš ï¸  Changed file tests not available, running full suite..."
  npm test --silent || { echo "âŒ Tests failed. Commit aborted."; exit 1; }
}

if grep -q "\"lint-staged\"" package.json 2>/dev/null; then
  echo "ğŸ§¹ Running lint-staged..."
  npx lint-staged || { echo "âŒ Lint-staged failed. Commit aborted."; exit 1; }
fi

echo "âœ… Pre-commit checks passed."
